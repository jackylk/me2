# Me2 CLI 聊天客户端使用指南

一个简洁、功能完整的命令行聊天工具，方便快速测试和使用Me2 AI。

---

## 🚀 快速开始

### 方法1: 使用启动脚本（推荐）
```bash
cd /Users/jacky/code/me2
./start_cli.sh
```

### 方法2: 直接运行Python脚本
```bash
cd /Users/jacky/code/me2
python3 cli_chat.py
```

---

## 📋 功能特性

### ✨ 核心功能
- ✅ 用户注册/登录
- ✅ 实时AI对话
- ✅ 记忆召回显示
- ✅ 彩色终端输出
- ✅ 会话管理
- ✅ 时间戳显示

### 🎨 视觉效果
- 蓝色 - 用户消息
- 绿色 - AI消息
- 黄色 - 系统提示
- 青色 - 元数据信息
- 红色 - 错误信息

---

## 📖 使用说明

### 启动选项

启动CLI后，会看到三个选项：

```
选择操作:
  1. 登录
  2. 注册新账号
  3. 快速开始（自动创建测试账号）
```

#### 选项1: 登录
使用已有账号登录
```
请选择 (1/2/3): 1
用户名: jacky
密码: ******
```

#### 选项2: 注册新账号
创建新账号
```
请选择 (1/2/3): 2
用户名: jacky
邮箱: jacky@test.com
密码: ******
```

#### 选项3: 快速开始（推荐测试使用）
自动创建随机测试账号，无需输入
```
请选择 (1/2/3): 3
⚡ 快速创建测试账号...
   用户名: cli_user_1533
✅ 注册成功！欢迎，cli_user_1533！
```

### 聊天交互

登录成功后，进入聊天模式：

```
💬 开始聊天（输入 'quit' 或 'exit' 退出）
────────────────────────────────────────────────────────────

你: 你好，我叫张三
  ⏳ 思考中...

[16:20:15] Me2:
  你好呀，张三！很高兴认识你！😊 今天过得怎么样？
```

### 退出程序

输入以下任一命令退出：
- `quit`
- `exit`
- `q`
- `退出`

或按 `Ctrl+C` 强制退出

---

## 🎯 使用示例

### 示例1: 快速测试
```bash
$ ./start_cli.sh

请选择 (1/2/3): 3
⚡ 快速创建测试账号...
✅ 注册成功！

你: 你好
[16:20:15] Me2:
  你好！今天过得怎么样？😊

你: quit
👋 再见！
```

### 示例2: 测试记忆功能
```bash
你: 你好，我叫李四，我是医生，喜欢跑步

[16:20:15] Me2:
  李四你好！医生是很伟大的职业呢！你平时多久跑一次步呀？

你: 我每周跑3次，每次5公里

[16:20:20] Me2:
  哇，每周三次，每次5公里，坚持得真好！👍

你: （等待30秒后）你还记得我的名字和职业吗？

[16:21:00] Me2:
  当然记得！你是李四，一位医生，而且还坚持跑步锻炼！😊
  💡 召回 2 条记忆
```

### 示例3: 多轮对话
```bash
你: 我今天心情不太好

[16:20:15] Me2:
  怎么了？愿意跟我说说吗？我会好好听的。

你: 工作上遇到了一些困难

[16:20:18] Me2:
  工作上的困难确实挺让人烦心的。是技术问题还是人际关系方面的呢？

你: 谢谢你的倾听

[16:20:22] Me2:
  不客气呀！有什么想聊的随时都可以找我，希望你快点好起来！💪
```

---

## 🔧 技术细节

### 自动处理代理
CLI会自动禁用HTTP代理，确保能连接到本地后端：
```python
os.environ['NO_PROXY'] = '*'
os.environ['no_proxy'] = '*'
```

### 后端连接检查
启动时自动检查后端是否运行：
```
❌ 无法连接到后端服务 (http://127.0.0.1:8000)
   请先启动后端: cd backend && uvicorn app.main:app --reload
```

### API端点
```
注册: POST /api/v1/auth/register
登录: POST /api/v1/auth/login
聊天: POST /api/v1/chat/
```

---

## 💡 使用技巧

### 1. 测试记忆功能
进行多轮对话，让AI积累记忆：
```
第1轮: 介绍自己（姓名、职业、爱好）
第2轮: 分享更多信息（家人、习惯、喜好）
第3轮: 讲述经历或故事
第4轮: 询问AI是否记得你
```

### 2. 观察元数据
注意AI回复下方的元数据显示：
```
💡 召回 3 条记忆 | 使用 1 条洞察
```
这表示AI使用了记忆系统

### 3. 连续对话
不要频繁退出重启，保持在同一会话中对话，有助于记忆积累

### 4. 自然表达
像和朋友聊天一样自然表达，AI会学习你的语气和习惯

---

## 📊 显示信息说明

### 消息格式
```
[16:20:15] Me2:              ← 时间戳 + 发言者
  消息内容...                ← 缩进的消息内容
  💡 召回 2 条记忆           ← 元数据（可选）
```

### 状态提示
- `⏳ 思考中...` - AI正在生成回复
- `✅` - 操作成功
- `❌` - 操作失败
- `💡` - 记忆/洞察信息
- `👋` - 再见消息

---

## 🐛 常见问题

### Q1: 提示"无法连接到后端服务"
**解决方案：**
```bash
# 启动后端
cd backend
source venv/bin/activate
uvicorn app.main:app --reload
```

### Q2: AI回复很慢
**原因：** DeepSeek API调用需要2-3秒
**正常范围：** 2-5秒

### Q3: AI不记得我说过的话
**原因：**
- 新用户记忆未积累
- NeuroMemory记忆提取是异步的

**建议：** 进行10+轮对话后再测试

### Q4: 出现代理错误
**解决方案：** CLI已自动禁用代理，如仍有问题，手动关闭系统代理

---

## 🎨 自定义配置

### 修改API地址
编辑 `cli_chat.py` 第14行：
```python
def __init__(self, api_url: str = "http://127.0.0.1:8000/api/v1"):
```

### 修改颜色方案
编辑 `cli_chat.py` 第22-29行的 `Colors` 类

### 修改超时时间
编辑对应函数的 `timeout` 参数：
```python
timeout=30  # 聊天超时30秒
timeout=10  # 登录超时10秒
```

---

## 📝 文件说明

| 文件 | 说明 |
|------|------|
| `cli_chat.py` | CLI主程序 |
| `start_cli.sh` | 启动脚本（自动禁用代理） |
| `CLI_GUIDE.md` | 本使用指南 |

---

## 🚀 高级用法

### 脚本化测试
```bash
# 自动输入命令进行测试
./start_cli.sh << EOF
3
你好，我是测试用户
我喜欢编程
quit
EOF
```

### 后台运行
```bash
# 使用 nohup 后台运行
nohup ./start_cli.sh > cli_output.log 2>&1 &
```

### 日志记录
```bash
# 记录对话到文件
./start_cli.sh | tee conversation.log
```

---

## 🎉 开始使用

现在就开始吧！

```bash
cd /Users/jacky/code/me2
./start_cli.sh
```

选择 `3` (快速开始)，然后输入：
```
你好，我叫[你的名字]，我是[职业]，喜欢[爱好]
```

开始与Me2的对话之旅！💬

---

**版本**: v1.0
**创建日期**: 2026-02-13
**Python要求**: Python 3.7+
**依赖**: requests
